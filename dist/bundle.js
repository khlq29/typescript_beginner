(()=>{"use strict";class e{templateElement;hostElement;element;constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}function n(e){let t=!0;return e.required&&(t=t&&0!==e.value?.toString().trim().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{id;title;description;people;status;constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i{listeners=[];addListener(e){this.listeners.push(e)}}class l extends i{projects=[];static instance;constructor(){super()}static getInstance(){return this.instance||(this.instance=new l),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const o=l.getInstance();class a extends e{titleInputElement;descriptionInputElement;peopleInputElement;constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,t=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:t,required:!0,minLength:5},i={value:+r,required:!0,min:1,max:5};return n({value:e,required:!0})&&n(s)&&n(i)?[e,t,+r]:void alert("Invalid input, please try again!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;console.log(e,n,r),o.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([t],a.prototype,"submitHandler",null);class c extends e{project;get persons(){return 1===this.project.people?"1 person":`${this.project.people} persons`}constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("DragEnd")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([t],c.prototype,"dragStartHandler",null);var d=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class p extends e{type;assignedProjects;constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.element.id=`${this.type}-projects`,this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeavehandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeavehandler),this.element.addEventListener("drop",this.dropHandler),o.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProject()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProject(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new c(this.element.querySelector("ul").id,e)}}d([t],p.prototype,"dragOverHandler",null),d([t],p.prototype,"dropHandler",null),d([t],p.prototype,"dragLeavehandler",null),new a,new p("active"),new p("finished"),console.log("hi")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVuZGxlLmpzIiwibWFwcGluZ3MiOiJtQkFLZSxNQUFlQSxFQUMxQkMsZ0JBQ0FDLFlBQ0FDLFFBRUEsV0FBQUMsQ0FDSUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FFQUMsS0FBS1IsZ0JBQXdDUyxTQUFTQyxlQUFlTixHQUNyRUksS0FBS1AsWUFBY1EsU0FBU0MsZUFBZUwsR0FFM0MsTUFBTU0sRUFBZUYsU0FBU0csV0FBV0osS0FBS1IsZ0JBQWdCYSxTQUFTLEdBQ3ZFTCxLQUFLTixRQUFVUyxFQUFhRyxrQkFDeEJQLElBQ0FDLEtBQUtOLFFBQVFhLEdBQUtSLEdBRXRCQyxLQUFLUSxPQUFPVixFQUNoQixDQUVRLE1BQUFVLENBQU9DLEdBQ1hULEtBQUtQLFlBQVlpQixzQkFBc0JELEVBQW9CLGFBQWUsWUFBYVQsS0FBS04sUUFDaEcsRUN6QkcsU0FBU2lCLEVBQVNDLEVBQWNDLEVBQXFCQyxHQUN4RCxNQUFNQyxFQUFpQkQsRUFBV0UsTUFTbEMsTUFSMkMsQ0FDdkNDLGNBQWMsRUFFZCxHQUFBQyxHQUVJLE9BRGdCSCxFQUFlSSxLQUFLbkIsS0FFeEMsRUFHUixDQ0pPLFNBQVNvQixFQUFTQyxHQUNyQixJQUFJQyxHQUFVLEVBZ0JkLE9BZklELEVBQWlCRSxXQUNqQkQsRUFBVUEsR0FBZ0UsSUFBckRELEVBQWlCTCxPQUFPUSxXQUFXQyxPQUFPQyxRQUVqQyxNQUE5QkwsRUFBaUJNLFdBQXVELGlCQUEzQk4sRUFBaUJMLFFBQzlETSxFQUFVQSxHQUFXRCxFQUFpQkwsTUFBTVUsUUFBVUwsRUFBaUJNLFdBRXpDLE1BQTlCTixFQUFpQk8sV0FBdUQsaUJBQTNCUCxFQUFpQkwsUUFDOURNLEVBQVVBLEdBQVdELEVBQWlCTCxNQUFNVSxRQUFVTCxFQUFpQk8sV0FFL0MsTUFBeEJQLEVBQWlCUSxLQUFpRCxpQkFBM0JSLEVBQWlCTCxRQUN4RE0sRUFBVUEsR0FBV0QsRUFBaUJMLE9BQVNLLEVBQWlCUSxLQUV4QyxNQUF4QlIsRUFBaUJTLEtBQWlELGlCQUEzQlQsRUFBaUJMLFFBQ3hETSxFQUFVQSxHQUFXRCxFQUFpQkwsT0FBU0ssRUFBaUJTLEtBRTdEUixDQUNYLENDM0JHLElBQVlTLEdBQVosU0FBWUEsR0FBZ0IsdUJBQVEsMEJBQVUsQ0FBOUMsQ0FBWUEsSUFBQUEsRUFBYSxLQUVsQixNQUFNQyxFQUVEekIsR0FDQTBCLE1BQ0FDLFlBQ0FDLE9BQ0FDLE9BTFgsV0FBQXpDLENBQ1dZLEVBQ0EwQixFQUNBQyxFQUNBQyxFQUNBQyxHQUpBLEtBQUE3QixHQUFBQSxFQUNBLEtBQUEwQixNQUFBQSxFQUNBLEtBQUFDLFlBQUFBLEVBQ0EsS0FBQUMsT0FBQUEsRUFDQSxLQUFBQyxPQUFBQSxDQUVYLEVDTkosTUFBTUMsRUFDUUMsVUFBMkIsR0FFckMsV0FBQUMsQ0FBWUMsR0FDUnhDLEtBQUtzQyxVQUFVRyxLQUFLRCxFQUN4QixFQUVHLE1BQU1FLFVBQXFCTCxFQUN0Qk0sU0FBc0IsR0FDdEJDLGdCQUVSLGNBQ0lDLE9BQ0osQ0FFQSxrQkFBT0MsR0FDSCxPQUFJOUMsS0FBSytDLFdBR1QvQyxLQUFLK0MsU0FBVyxJQUFJTCxHQUZUMUMsS0FBSytDLFFBSXBCLENBRUEsVUFBQUMsQ0FBV2YsRUFBZUMsRUFBc0JlLEdBQzVDLE1BQU1DLEVBQWEsSUFBSWxCLEVBQVFtQixLQUFLQyxTQUFTNUIsV0FBWVMsRUFBUUMsRUFBYWUsRUFBY2xCLEVBQWNzQixRQUMxR3JELEtBQUsyQyxTQUFTRixLQUFLUyxHQUNuQmxELEtBQUtzRCxpQkFDVCxDQUVBLFdBQUFDLENBQVlDLEVBQW1CQyxHQUMzQixNQUFNQyxFQUFVMUQsS0FBSzJDLFNBQVNnQixNQUFLQyxHQUFPQSxFQUFJckQsS0FBT2lELElBQ2pERSxHQUFXQSxFQUFRdEIsU0FBV3FCLElBQzlCQyxFQUFRdEIsT0FBU3FCLEVBQ2pCekQsS0FBS3NELGtCQUViLENBRVEsZUFBQUEsR0FDSixJQUFLLE1BQU1kLEtBQWN4QyxLQUFLc0MsVUFDMUJFLEVBQVd4QyxLQUFLMkMsU0FBU2tCLFFBRWpDLEVBR0csTUFBTUMsRUFBZXBCLEVBQWFJLGNDeENsQyxNQUFNaUIsVUFBcUIsRUFFOUJDLGtCQUNBQyx3QkFDQUMsbUJBRUEsV0FBQXZFLEdBQ0lrRCxNQUFNLGdCQUFpQixPQUFPLEVBQU0sY0FDcEM3QyxLQUFLZ0Usa0JBQW9CaEUsS0FBS04sUUFBUXlFLGNBQWMsVUFDcERuRSxLQUFLaUUsd0JBQTBCakUsS0FBS04sUUFBUXlFLGNBQWMsZ0JBQzFEbkUsS0FBS2tFLG1CQUFxQmxFLEtBQUtOLFFBQVF5RSxjQUFjLFdBQ3JEbkUsS0FBS29FLFdBQ1QsQ0FFQSxTQUFBQSxHQUNJcEUsS0FBS04sUUFBUTJFLGlCQUFpQixTQUFVckUsS0FBS3NFLGNBQ2pELENBRUEsYUFBQUMsR0FBaUIsQ0FFVCxlQUFBQyxHQUNKLE1BQU1DLEVBQWV6RSxLQUFLZ0Usa0JBQWtCaEQsTUFDdEMwRCxFQUFxQjFFLEtBQUtpRSx3QkFBd0JqRCxNQUNsRDJELEVBQWdCM0UsS0FBS2tFLG1CQUFtQmxELE1BU3ZDNEQsRUFBaUQsQ0FDcEQ1RCxNQUFPMEQsRUFDUG5ELFVBQVUsRUFDVkksVUFBVyxHQUdSa0QsRUFBNEMsQ0FDL0M3RCxPQUFRMkQsRUFDUnBELFVBQVUsRUFDVk0sSUFBSyxFQUNMQyxJQUFLLEdBR1QsT0FDSyxFQXBCNEMsQ0FDN0NkLE1BQU95RCxFQUNQbEQsVUFBVSxLQW1CVCxFQUFvQnFELElBQ3BCLEVBQW9CQyxHQUtkLENBQUNKLEVBQWVDLEdBQXNCQyxRQUg3Q0csTUFBTSxtQ0FNZCxDQUVRLFdBQUFDLEdBQ0ovRSxLQUFLZ0Usa0JBQWtCaEQsTUFBUSxHQUMvQmhCLEtBQUtpRSx3QkFBd0JqRCxNQUFRLEdBQ3JDaEIsS0FBS2tFLG1CQUFtQmxELE1BQVEsRUFDcEMsQ0FHUSxhQUFBc0QsQ0FBY1UsR0FDbEJBLEVBQU1DLGlCQUNOLE1BQU1DLEVBQVlsRixLQUFLd0Usa0JBRXZCLEdBQUlXLE1BQU1DLFFBQVFGLEdBQVksQ0FDMUIsTUFBT2pELEVBQU9vRCxFQUFNbEQsR0FBVStDLEVBQzlCSSxRQUFRQyxJQUFJdEQsRUFBT29ELEVBQU1sRCxHQUN6QjJCLEVBQWFkLFdBQVdmLEVBQU1vRCxFQUFLbEQsR0FDbkNuQyxLQUFLK0UsYUFDVCxDQUNKLEcsMFRBVlEsRUFEUCxHLGtDQy9ESyxNQUFNUyxVQUFvQmpHLEVBRXhCbUUsUUFFUixXQUFJK0IsR0FDQSxPQUE0QixJQUF4QnpGLEtBQUswRCxRQUFRdkIsT0FDTixXQUVBLEdBQUduQyxLQUFLMEQsUUFBUXZCLGdCQUUvQixDQUVBLFdBQUF4QyxDQUFZK0YsRUFBZ0JoQyxHQUN4QmIsTUFBTSxpQkFBa0I2QyxHQUFRLEVBQU9oQyxFQUFRbkQsSUFDL0NQLEtBQUswRCxRQUFVQSxFQUVmMUQsS0FBS29FLFlBQ0xwRSxLQUFLdUUsZUFDVCxDQUdBLGdCQUFBb0IsQ0FBaUJYLEdBQ2JBLEVBQU1ZLGFBQWNDLFFBQVEsYUFBYzdGLEtBQUswRCxRQUFRbkQsSUFDdkR5RSxFQUFNWSxhQUFjRSxjQUFnQixNQUN4QyxDQUVBLGNBQUFDLENBQWVmLEdBQ1hNLFFBQVFDLElBQUksVUFFaEIsQ0FFQSxTQUFBbkIsR0FDSXBFLEtBQUtOLFFBQVEyRSxpQkFBaUIsWUFBYXJFLEtBQUsyRixrQkFDaEQzRixLQUFLTixRQUFRMkUsaUJBQWlCLFVBQVdyRSxLQUFLK0YsZUFDbEQsQ0FFQSxhQUFBeEIsR0FDSXZFLEtBQUtOLFFBQVF5RSxjQUFjLE1BQU82QixZQUFjaEcsS0FBSzBELFFBQVF6QixNQUM3RGpDLEtBQUtOLFFBQVF5RSxjQUFjLE1BQU82QixZQUFjaEcsS0FBS3lGLFFBQVUsWUFDL0R6RixLQUFLTixRQUFReUUsY0FBYyxLQUFNNkIsWUFBY2hHLEtBQUswRCxRQUFReEIsV0FFaEUsRywwVEFwQkEsRUFEQ3ZCLEcsK1dDcEJFLE1BQU1zRixVQUFvQjFHLEVBR1QyRyxLQUZwQkMsaUJBRUEsV0FBQXhHLENBQW9CdUcsR0FDaEJyRCxNQUFNLGVBQWdCLE9BQVEsRUFBTyxHQUFHcUQsY0FEeEIsS0FBQUEsS0FBQUEsRUFFaEJsRyxLQUFLbUcsaUJBQW1CLEdBQ3hCbkcsS0FBS04sUUFBUWEsR0FBSyxHQUFHUCxLQUFLa0csZ0JBRTFCbEcsS0FBS29FLFlBQ0xwRSxLQUFLdUUsZUFDVCxDQUdBLGVBQUE2QixDQUFnQnBCLEdBQ1JBLEVBQU1ZLGNBQWdELGVBQWhDWixFQUFNWSxhQUFhUyxNQUFNLEtBQ2hEckIsRUFBTUMsaUJBQ1VqRixLQUFLTixRQUFReUUsY0FBYyxNQUNwQ21DLFVBQVVDLElBQUksYUFFNUIsQ0FHQSxXQUFBQyxDQUFZeEIsR0FDUixNQUFNeUIsRUFBUXpCLEVBQU1ZLGFBQWNjLFFBQVEsY0FDMUM1QyxFQUFhUCxZQUFZa0QsRUFBc0IsV0FBZHpHLEtBQUtrRyxLQUFvQm5FLEVBQWNzQixPQUFTdEIsRUFBYzRFLFNBQ25HLENBR0EsZ0JBQUFDLENBQWlCNUIsR0FDRWhGLEtBQUtOLFFBQVF5RSxjQUFjLE1BQ25DbUMsVUFBVU8sT0FBTyxZQUM1QixDQUVBLFNBQUF6QyxHQUNJcEUsS0FBS04sUUFBUTJFLGlCQUFpQixXQUFZckUsS0FBS29HLGlCQUMvQ3BHLEtBQUtOLFFBQVEyRSxpQkFBaUIsWUFBYXJFLEtBQUs0RyxrQkFDaEQ1RyxLQUFLTixRQUFRMkUsaUJBQWlCLE9BQVFyRSxLQUFLd0csYUFFM0MxQyxFQUFhdkIsYUFBYUksSUFDdEIsTUFBTW1FLEVBQW1CbkUsRUFBU29FLFFBQU9uRCxHQUNuQixXQUFkNUQsS0FBS2tHLEtBQ0N0QyxFQUFJeEIsU0FBV0wsRUFBY3NCLE9BRWhDTyxFQUFJeEIsU0FBV0wsRUFBYzRFLFdBRXhDM0csS0FBS21HLGlCQUFtQlcsRUFDeEI5RyxLQUFLZ0gsZUFBZSxHQUU1QixDQUVBLGFBQUF6QyxHQUNJLE1BQU0wQyxFQUFTLEdBQUdqSCxLQUFLa0cscUJBQ3ZCbEcsS0FBS04sUUFBUXlFLGNBQWMsTUFBTzVELEdBQUswRyxFQUN2Q2pILEtBQUtOLFFBQVF5RSxjQUFjLE1BQU82QixZQUFjaEcsS0FBS2tHLEtBQUtnQixjQUFlLFdBQzdFLENBRVMsYUFBQUYsR0FDVS9HLFNBQVNDLGVBQWUsR0FBR0YsS0FBS2tHLHNCQUN4Q2lCLFVBQVcsR0FDbEIsSUFBSyxNQUFNQyxLQUFXcEgsS0FBS21HLGlCQUN6QixJQUFJWCxFQUFZeEYsS0FBS04sUUFBUXlFLGNBQWMsTUFBTzVELEdBQUk2RyxFQUU1RCxFQWpEQSxHQURDekcsRyxvQ0FVRCxHQURDQSxHLGdDQU9ELEdBRENBLEcscUNDOUJZLElBQUksRUFDQyxJQUFJc0YsRUFBWSxVQUNkLElBQUlBLEVBQVksWUFHeENYLFFBQVFDLElBQUksSyIsInNvdXJjZXMiOlsid2VicGFjazovL3R5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0Ly4vc3JjL2RlY29yYXRvcnMvYXV0b2JpbmQudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC8uL3NyYy91dGlscy92YWxpZGF0aW9uLnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3R5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly90eXBlc2NyaXB0Ly4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuLy9Db21wb25lbnQgQmFzZSBDbGFzc1xyXG5cclxuZXhwb3J0IGNvbnN0IHNvbWV0aGluZyA9ICcuLi4nXHJcblxyXG5leHBvcnQgZGVmYXVsdCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQgPiB7XHJcbiAgICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnRcclxuICAgIGhvc3RFbGVtZW50OiBUXHJcbiAgICBlbGVtZW50OiBVXHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgdGVtcGxhdGVJZDogc3RyaW5nLFxyXG4gICAgICAgIGhvc3RFbGVtZW50SWQ6IHN0cmluZyxcclxuICAgICAgICBpbnNlcnRBdFN0YXJ0OiBib29sZWFuLCBcclxuICAgICAgICBuZXdFTGVtZW50SWQ/OiBzdHJpbmdcclxuICAgICkge1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gPEhUTUxUZW1wbGF0ZUVsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlbXBsYXRlSWQpITtcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkhIGFzIFRcclxuXHJcbiAgICAgICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LCB0cnVlKVxyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGltcG9ydGVkTm9kZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBVXHJcbiAgICAgICAgaWYgKG5ld0VMZW1lbnRJZCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFTGVtZW50SWRcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hdHRhY2goaW5zZXJ0QXRTdGFydClcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdEJlZ2lubmluZyA6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50Lmluc2VydEFkamFjZW50RWxlbWVudChpbnNlcnRBdEJlZ2lubmluZyA/ICdhZnRlcmJlZ2luJyA6ICdiZWZvcmVlbmQnLCB0aGlzLmVsZW1lbnQpXHJcbiAgICB9XHJcblxyXG4gICAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWRcclxuICAgIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZFxyXG59XHJcbiIsIlxyXG5cclxuLy9hdXRvYmluZCBkZWNvcmF0b3JcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBBdXRvYmluZCh0YXJnZXQgOiBhbnksIG1ldGhvZE5hbWUgOiBzdHJpbmcsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcil7XHJcbiAgICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWVcclxuICAgIGNvbnN0IGFkakRlc2NyaXB0b3IgOiBQcm9wZXJ0eURlc2NyaXB0b3IgPSB7XHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIC8vZW51bWVyYWJsZSA6IGZhbHNlLFxyXG4gICAgICAgIGdldCgpe1xyXG4gICAgICAgICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKVxyXG4gICAgICAgICAgICByZXR1cm4gYm91bmRGblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBhZGpEZXNjcmlwdG9yXHJcbn1cclxuIiwiXHJcbi8vVmFsaWRhdGlvblxyXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRhYmxle1xyXG4gICAgdmFsdWU/OiBzdHJpbmcgfCBudW1iZXI7XHJcbiAgICByZXF1aXJlZD86IGJvb2xlYW47XHJcbiAgICBtaW5MZW5ndGg/OiBudW1iZXJcclxuICAgIG1heExlbmd0aD86IG51bWJlclxyXG4gICAgbWluPzogbnVtYmVyXHJcbiAgICBtYXg/OiBudW1iZXJcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQ6IFZhbGlkYXRhYmxlKSB7XHJcbiAgICBsZXQgaXNWYWxpZCA9IHRydWU7XHJcbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5yZXF1aXJlZCkge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWU/LnRvU3RyaW5nKCkudHJpbSgpLmxlbmd0aCAhPT0gMFxyXG4gICAgfVxyXG4gICAgaWYgKHZhbGlkYXRhYmxlSW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPj0gdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGhcclxuICAgIH1cclxuICAgIGlmICh2YWxpZGF0YWJsZUlucHV0Lm1heExlbmd0aCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoIDw9IHZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RoXHJcbiAgICB9XHJcbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5taW4gIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID49IHZhbGlkYXRhYmxlSW5wdXQubWluXHJcbiAgICB9XHJcbiAgICBpZiAodmFsaWRhdGFibGVJbnB1dC5tYXggIT0gbnVsbCAmJiB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlIDw9IHZhbGlkYXRhYmxlSW5wdXQubWF4XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaXNWYWxpZFxyXG59XHJcbiIsIlxyXG4vL1Byb2plY3QgVHlwZVxyXG4gICBleHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHsgQWN0aXZlLCBGaW5pc2hlZCB9XHJcblxyXG4gICBleHBvcnQgY2xhc3MgUHJvamVjdHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBpZDogc3RyaW5nLFxyXG4gICAgICAgIHB1YmxpYyB0aXRsZTogc3RyaW5nLFxyXG4gICAgICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG4gICAgICAgIHB1YmxpYyBwZW9wbGU6IG51bWJlcixcclxuICAgICAgICBwdWJsaWMgc3RhdHVzOiBQcm9qZWN0U3RhdHVzXHJcbiAgICApIHsgICAgXHJcbiAgICB9XHJcbiAgfSBcclxuXHJcblxyXG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnXHJcbiAgICBcclxuLy9Qcm9qZWN0IFN0YXRlIE1hbmFnZW1lbnRcclxuXHJcbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6VFtdKSA9PiB2b2lkXHJcblxyXG5jbGFzcyBTdGF0ZSA8VD4ge1xyXG4gICAgcHJvdGVjdGVkIGxpc3RlbmVyczogTGlzdGVuZXI8VD5bXSA9IFtdXHJcbiAgICBcclxuICAgIGFkZExpc3RlbmVyKGxpc3RlbmVyRm4gOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXJGbilcclxuICAgIH1cclxufVxyXG5leHBvcnQgY2xhc3MgUHJvamVjdFN0YXRlIGV4dGVuZHMgU3RhdGU8UHJvamVjdD57XHJcbiAgICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXVxyXG4gICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZVxyXG4gICAgXHJcbiAgICBwcml2YXRlIGNvbnN0cnVjdG9yKCkgeyBcclxuICAgICAgICBzdXBlcigpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmluc3RhbmNlID0gbmV3IFByb2plY3RTdGF0ZSgpXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VcclxuICAgIH1cclxuXHJcbiAgICBhZGRQcm9qZWN0KHRpdGxlOiBzdHJpbmcsIGRlc2NyaXB0aW9uIDogc3RyaW5nLCBudW1PZlBlb3BsZTogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSwgdGl0bGUgLCBkZXNjcmlwdGlvbiwgbnVtT2ZQZW9wbGUgLCBQcm9qZWN0U3RhdHVzLkFjdGl2ZSlcclxuICAgICAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdClcclxuICAgICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIG1vdmVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcclxuICAgICAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHByaiA9PiBwcmouaWQgPT09IHByb2plY3RJZClcclxuICAgICAgICBpZiAocHJvamVjdCAmJiBwcm9qZWN0LnN0YXR1cyAhPT0gbmV3U3RhdHVzKSB7XHJcbiAgICAgICAgICAgIHByb2plY3Quc3RhdHVzID0gbmV3U3RhdHVzXHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBwcm9qZWN0U3RhdGUgPSBQcm9qZWN0U3RhdGUuZ2V0SW5zdGFuY2UoKVxyXG5cclxuXHJcbiIsImltcG9ydCBDbXAgZnJvbSAnLi9iYXNlLWNvbXBvbmVudCdcclxuaW1wb3J0IHsgQXV0b2JpbmQgYXMgYXV0b30gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCcgIC8vIHdlIGNhbiBhbHNvIGFzc2lnbiBhbGlhc2UgbmFtZXNcclxuaW1wb3J0ICogYXMgVmFsaWRhdGlvbiBmcm9tICcuLi91dGlscy92YWxpZGF0aW9uJyAvL2dyb3VwaW5nIC0tPiB3ZSBjYW4gY2FsbCB0aGUgZnVuc2N0aW9ucyB1c2luZyB0aGUgdmFyaWFibGUgbmFtZSB3ZSBnYXZlIGxpa2UgJ1ZhbGlkYXRpb24nXHJcbi8vaW1wb3J0IHsgdmFsaWRhdGUgfSBmcm9tICcuLi91dGlscy92YWxpZGF0aW9uLmpzJ1xyXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlJ1xyXG5cclxuXHJcblxyXG4vL1Byb2plY3RJbnB1dCBjbGFzc1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENtcDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PiB7XHJcblxyXG4gICAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnRcclxuICAgIGRlc2NyaXB0aW9uSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50XHJcbiAgICBwZW9wbGVJbnB1dEVsZW1lbnQgOiBIVE1MSW5wdXRFbGVtZW50XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKVxyXG4gICAgICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI3RpdGxlJykgYXMgSFRNTElucHV0RWxlbWVudFxyXG4gICAgICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignI2Rlc2NyaXB0aW9uJykgYXMgSFRNTElucHV0RWxlbWVudFxyXG4gICAgICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwZW9wbGUnKSBhcyBIVE1MSW5wdXRFbGVtZW50XHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpIHsgXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHRoaXMuc3VibWl0SGFuZGxlcilcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJDb250ZW50KCkge31cclxuXHJcbiAgICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOiBbc3RyaW5nLCBzdHJpbmcsIG51bWJlcl0gfCB2b2lkIHtcclxuICAgICAgICBjb25zdCBlbnRlcmVkVGl0bGUgPSB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlO1xyXG4gICAgICAgIGNvbnN0IGVudGVyZWREZXNjcmlwdGlvbiA9IHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9IHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlO1xyXG5cclxuXHJcbiAgICAgICAgY29uc3QgdGl0bGVWYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcclxuICAgICAgICAgICAgdmFsdWU6IGVudGVyZWRUaXRsZSxcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIC8vIG1heExlbmd0aCA6IDEwXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcclxuICAgICAgICAgICAgdmFsdWU6IGVudGVyZWREZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIG1pbkxlbmd0aDogNVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgIGNvbnN0IHBlb3BsZVZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgICAgICB2YWx1ZTogK2VudGVyZWRQZW9wbGUsXHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICBtaW46IDEsXHJcbiAgICAgICAgICAgIG1heDogNVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZSh0aXRsZVZhbGlkYXRhYmxlKSB8fFxyXG4gICAgICAgICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZShkZXNjcmlwdGlvblZhbGlkYXRhYmxlKSB8fFxyXG4gICAgICAgICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSlcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgYWxlcnQoJ0ludmFsaWQgaW5wdXQsIHBsZWFzZSB0cnkgYWdhaW4hJylcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbZW50ZXJlZFRpdGxlICwgZW50ZXJlZERlc2NyaXB0aW9uICwgK2VudGVyZWRQZW9wbGVdXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsZWFySW5wdXRzKCkge1xyXG4gICAgICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICAgICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBAYXV0b1xyXG4gICAgcHJpdmF0ZSBzdWJtaXRIYW5kbGVyKGV2ZW50OiBFdmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUpO1xyXG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpIHtcclxuICAgICAgICAgICAgY29uc3QgW3RpdGxlLCBkZXNjLCBwZW9wbGVdID0gdXNlcklucHV0XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRpdGxlLCBkZXNjLCBwZW9wbGUpO1xyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSxkZXNjLHBlb3BsZSlcclxuICAgICAgICAgICAgdGhpcy5jbGVhcklucHV0cygpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8vZXMgbW9kdWxlIHN5bnRheCBmb3IgaW1wb3J0aW5nXHJcbmltcG9ydCB7IERyYWdnYWJsZSB9IGZyb20gJy4uL21vZGVscy9kcmFnLWRyb3AnXHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCdcclxuaW1wb3J0ICBDb21wb25lbnQgIGZyb20gJy4vYmFzZS1jb21wb25lbnQnXHJcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCdcclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgLy9Qcm9qZWN0SXRlbSBjbGFzc1xyXG4gICBleHBvcnQgY2xhc3MgUHJvamVjdEl0ZW0gZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCAsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgRHJhZ2dhYmxlIHtcclxuICAgIFxyXG4gICAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0XHJcbiAgICBcclxuICAgIGdldCBwZXJzb25zKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb2plY3QucGVvcGxlID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnMSBwZXJzb24nXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGAke3RoaXMucHJvamVjdC5wZW9wbGV9IHBlcnNvbnNgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGhvc3RJZDogc3RyaW5nLCBwcm9qZWN0OiBQcm9qZWN0KSB7XHJcbiAgICAgICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0JywgaG9zdElkLCBmYWxzZSwgcHJvamVjdC5pZClcclxuICAgICAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKClcclxuICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBAQXV0b2JpbmRcclxuICAgIGRyYWdTdGFydEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZClcclxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSdcclxuICAgIH1cclxuXHJcbiAgICBkcmFnRW5kSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0RyYWdFbmQnKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBjb25maWd1cmUoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcilcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlbmRlckNvbnRlbnQoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LnRpdGxlXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZCdcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigncCcpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC5kZXNjcmlwdGlvblxyXG5cclxuICAgIH1cclxuXHJcbn1cclxuIiwiaW1wb3J0ICBDb21wb25lbnQgIGZyb20gJy4vYmFzZS1jb21wb25lbnQnXHJcbmltcG9ydCB7IEF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCdcclxuaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdFN0YXR1cyB9IGZyb20gJy4uL21vZGVscy9wcm9qZWN0J1xyXG5pbXBvcnQgeyBwcm9qZWN0U3RhdGUgfSBmcm9tICcuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlJ1xyXG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCdcclxuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tICcuL3Byb2plY3QtaXRlbSdcclxuXHJcblxyXG5cclxuLy9Qcm9qZWN0TGlzdCBjbGFzc1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PCBIVE1MRGl2RWxlbWVudCAsSFRNTEVsZW1lbnQgPiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xyXG4gICAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdXHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB0eXBlOiAnYWN0aXZlJyB8ICdmaW5pc2hlZCcpIHtcclxuICAgICAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcgLCBmYWxzZSAsYCR7dHlwZX0tcHJvamVjdHNgKVxyXG4gICAgICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IFtdXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmlkID0gYCR7dGhpcy50eXBlfS1wcm9qZWN0c2BcclxuXHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKVxyXG4gICAgICAgIHRoaXMucmVuZGVyQ29udGVudCgpXHJcbiAgICB9XHJcblxyXG4gICAgQEF1dG9iaW5kXHJcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcclxuICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcbiAgICAgICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIVxyXG4gICAgICAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKSBcclxuICAgICAgICB9IFxyXG4gICAgfVxyXG5cclxuICAgIEBBdXRvYmluZFxyXG4gICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KHByaklkICwgdGhpcy50eXBlID09PSAnYWN0aXZlJyA/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZCApXHJcbiAgICB9XHJcbiAgICBcclxuICAgIEBBdXRvYmluZFxyXG4gICAgZHJhZ0xlYXZlaGFuZGxlcihldmVudDogRHJhZ0V2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhXHJcbiAgICAgICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpXHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKVxyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCB0aGlzLmRyYWdMZWF2ZWhhbmRsZXIpXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2Ryb3AnLCB0aGlzLmRyb3BIYW5kbGVyKVxyXG5cclxuICAgICAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVsZXZhbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcihwcmogPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScpIHtcclxuICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZSBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmFudFByb2plY3RzXHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyUHJvamVjdCgpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJDb250ZW50KCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGBcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWRcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSsgJyBQUk9KRUNUUydcclxuICAgIH1cclxuXHJcbiAgICAgcHJpdmF0ZSByZW5kZXJQcm9qZWN0KCkge1xyXG4gICAgICAgIGNvbnN0IGxpc3RFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGApISBhcyBIVE1MVUxpc3RFbGVtZW50XHJcbiAgICAgICAgbGlzdEVsLmlubmVySFRNTCA9JydcclxuICAgICAgICBmb3IgKGNvbnN0IHByakl0ZW0gb2YgdGhpcy5hc3NpZ25lZFByb2plY3RzKSB7XHJcbiAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcmpJdGVtKSAgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIlxyXG5cclxuaW1wb3J0IHtQcm9qZWN0SW5wdXQgYXMgUEluIH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQnXHJcbmltcG9ydCB7UHJvamVjdExpc3R9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3QnXHJcblxyXG5cclxuXHJcblxyXG5jb25zdCBwcmpJbnB1dCA9IG5ldyBQSW4oKVxyXG5jb25zdCBhY3RpdmVQcmpMaXN0ID0gbmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKVxyXG5jb25zdCBmaW5pc2hlZFByakxpc3QgPSBuZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJylcclxuXHJcblxyXG5jb25zb2xlLmxvZygnaGknKTsiXSwibmFtZXMiOlsiQ29tcG9uZW50IiwidGVtcGxhdGVFbGVtZW50IiwiaG9zdEVsZW1lbnQiLCJlbGVtZW50IiwiY29uc3RydWN0b3IiLCJ0ZW1wbGF0ZUlkIiwiaG9zdEVsZW1lbnRJZCIsImluc2VydEF0U3RhcnQiLCJuZXdFTGVtZW50SWQiLCJ0aGlzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEF0QmVnaW5uaW5nIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiQXV0b2JpbmQiLCJ0YXJnZXQiLCJtZXRob2ROYW1lIiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwidmFsdWUiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwidmFsaWRhdGUiLCJ2YWxpZGF0YWJsZUlucHV0IiwiaXNWYWxpZCIsInJlcXVpcmVkIiwidG9TdHJpbmciLCJ0cmltIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiU3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyRm4iLCJwdXNoIiwiUHJvamVjdFN0YXRlIiwicHJvamVjdHMiLCJzdGF0aWMiLCJzdXBlciIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0IiwibnVtT2ZQZW9wbGUiLCJuZXdQcm9qZWN0IiwiTWF0aCIsInJhbmRvbSIsIkFjdGl2ZSIsInVwZGF0ZUxpc3RlbmVycyIsIm1vdmVQcm9qZWN0IiwicHJvamVjdElkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwcmoiLCJzbGljZSIsInByb2plY3RTdGF0ZSIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29uZmlndXJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Ym1pdEhhbmRsZXIiLCJyZW5kZXJDb250ZW50IiwiZ2F0aGVyVXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZW50ZXJlZERlc2NyaXB0aW9uIiwiZW50ZXJlZFBlb3BsZSIsImRlc2NyaXB0aW9uVmFsaWRhdGFibGUiLCJwZW9wbGVWYWxpZGF0YWJsZSIsImFsZXJ0IiwiY2xlYXJJbnB1dHMiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiZGVzYyIsImNvbnNvbGUiLCJsb2ciLCJQcm9qZWN0SXRlbSIsInBlcnNvbnMiLCJob3N0SWQiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJkcmFnRW5kSGFuZGxlciIsInRleHRDb250ZW50IiwiUHJvamVjdExpc3QiLCJ0eXBlIiwiYXNzaWduZWRQcm9qZWN0cyIsImRyYWdPdmVySGFuZGxlciIsInR5cGVzIiwiY2xhc3NMaXN0IiwiYWRkIiwiZHJvcEhhbmRsZXIiLCJwcmpJZCIsImdldERhdGEiLCJGaW5pc2hlZCIsImRyYWdMZWF2ZWhhbmRsZXIiLCJyZW1vdmUiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdCIsImxpc3RJZCIsInRvVXBwZXJDYXNlIiwiaW5uZXJIVE1MIiwicHJqSXRlbSJdLCJzb3VyY2VSb290IjoiIn0=